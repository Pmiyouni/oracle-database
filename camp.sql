--캠핑장테이블 생성
CREATE TABLE CAMP(
  CNO CHAR(3) PRIMARY KEY NOT NULL, --캠핑장 번호
  CNAME VARCHAR(100) NOT NULL, -- 캠핑장면
  JUSO VARCHAR(500), --주소
  TEL VARCHAR(20)  --전화
);

INSERT INTO CAMP(CNO, CNAME, JUSO, TEL)
VALUES('100', '도토리캠핑장', '강원도', '010-1010-1010');
INSERT INTO CAMP(CNO, CNAME, JUSO, TEL)
VALUES('101', '솔밭캠핑장', '경기도', '010-1010-2020');
INSERT INTO CAMP(CNO, CNAME, JUSO, TEL)
VALUES('102', '하늘캠핑장', '인천', '010-1010-3030');
SELECT * FROM CAMP;

--시설물 테이블 생성
CREATE TABLE FACIL(
  FNO INT PRIMARY KEY NOT NULL, --시설물 번호
  FNAME VARCHAR(100) NOT NULL --시설물명
);
INSERT INTO FACIL VALUES(0,'전기');
INSERT INTO FACIL VALUES(1,'수도');
INSERT INTO FACIL VALUES(2,'와이파이');
INSERT INTO FACIL VALUES(3,'화장실');
INSERT INTO FACIL VALUES(4,'수영장');
SELECT * FROM FACIL;

--타입 테이블 생성
CREATE TABLE TYPE(
  TNO INT PRIMARY KEY NOT NULL, -- 타입 번호
  TNAME VARCHAR(100) NOT NULL --타입명
);
INSERT INTO TYPE VALUES(0, '카라반');
INSERT INTO TYPE VALUES(1, '글램핑');
INSERT INTO TYPE VALUES(2, '오토캠핑');
INSERT INTO TYPE VALUES(3, '펜션');
SELECT * FROM TYPE;

--캠핑장별 시설물 테이블 생성
CREATE TABLE CAMP_FACIL( 
  CNO CHAR(3) NOT NULL,   --캠핑장 번호
  FNO INT NOT NULL,   --시설물 번호
  PRIMARY KEY(CNO, FNO),  -- 둘다 프라이머리 키 설정
  FOREIGN KEY(CNO) REFERENCES CAMP(CNO), --외래키를 캠핑장테이블의 캠핑장번호 참조
  FOREIGN KEY(FNO) REFERENCES FACIL(FNO)--외래키를 시설물테이블의 시설물번호 참조
);  
  
--캠핑장별 타입 테이블 생성
CREATE TABLE CAMP_TYPE(
  CNO CHAR(3) NOT NULL, --캠핑장 번호
  TNO INT NOT NULL,  --타입번호
  PRIMARY KEY(CNO, TNO), -- 둘다 프라이머리 키 설정
  FOREIGN KEY(CNO) REFERENCES CAMP(CNO), --외래키를 캠핑장테이블의 캠핑장번호 참조
  FOREIGN KEY(TNO) REFERENCES TYPE(TNO)  --외래키를 타입테이블의 타입번호 참조
);  

--캠핑장별 시설물 테이블 데이터 입력
--100번 캠핑장에 시설물 0,1,2
INSERT INTO CAMP_FACIL(CNO, FNO) VALUES('100',0);
INSERT INTO CAMP_FACIL(CNO, FNO) VALUES('100',1);
INSERT INTO CAMP_FACIL(CNO, FNO) VALUES('100',2);
--101번 캠핑장에 시설물 0,1
INSERT INTO CAMP_FACIL(CNO, FNO) VALUES('101',0);
INSERT INTO CAMP_FACIL(CNO, FNO) VALUES('101',1);
--102번 캠핑장에 시설물 0,3
INSERT INTO CAMP_FACIL(CNO, FNO) VALUES('102',0);
INSERT INTO CAMP_FACIL(CNO, FNO) VALUES('102',3);
SELECT * FROM CAMP_FACIL;

--캠핑장별 타입 데이터 입력
--100번 캠핑장에 1,2
INSERT INTO CAMP_TYPE(CNO, TNO) VALUES('100',1);
INSERT INTO CAMP_TYPE(CNO, TNO) VALUES('100',2);
--101번 시설물 1
INSERT INTO CAMP_TYPE(CNO, TNO) VALUES('101',1);
--102번 시설물 2
INSERT INTO CAMP_TYPE(CNO, TNO) VALUES('102',2);
SELECT * FROM CAMP_TYPE;



--캠핑장별 시설물번호, 시설물이름
SELECT C.*, F.FNAME --시설물 이름도 보여줌
FROM CAMP_FACIL C, FACIL F
WHERE C.FNO=F.FNO; --시설물 번호가 같은

SELECT C.*, F.FNAME
FROM CAMP_FACIL C, FACIL F
WHERE C.FNO=F.FNO AND CNO='100';


--캠핑장별 유형번호, 유형이름
SELECT C.*, T.TNAME  --타입명 보여줌
FROM CAMP_TYPE C, TYPE T
WHERE C.TNO=T.TNO; --타입이 같은

-- 뷰생성(캠핑장별 시설물번호, 시설물이름)
CREATE VIEW VIEW_FACIL AS
SELECT C.*, F.FNAME
FROM CAMP_FACIL C, FACIL F --캠핑장별 시설물, 시설물테이블 조인
WHERE C.FNO=F.FNO; --시설물 번호가 같은

CREATE VIEW VIEW_TYPE AS
SELECT C.*, T.TNAME
FROM CAMP_TYPE C, TYPE T --캠핑장별 타입, 타입테이블 조인
WHERE C.TNO=T.TNO; --타입번호가 같은

SELECT * FROM VIEW_TYPE;
COMMIT;

